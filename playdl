#!/bin/bash
cd /tmp
PlayName=$(zenity --entry --title="Playlist title?" --text="Title: ")
zenity --info --text="Please pick the download location for the audio"
AudioLocation=$(zenity --file-selection --directory)
zenity --info --text="Please pick the download location for the video"
VideoLocation=$(zenity --file-selection --directory)
PlayLink=$(zenity --entry --title="Please enter the YouTube url" --text="Link: ")
cd $AudioLocation
mkdir $PlayName
cd $PlayName
(youtube-dl -c -x --retries infinite -f 'bestaudio[ext=m4a]' --audio-quality 0 --no-overwrites --embed-thumbnail --youtube-skip-dash-manifest -o '%(playlist_index)s-%(title)s.%(ext)s' --exec "ffmpeg -i {}  -codec:a libmp3lame -qscale:a 0 {}.mp3 && rm {} " $PlayLink) |
zenity --progress \
	--title="Downloading audio" \
	--text="Fetching files from YouTube..." \
	--percentage=0 \
	--pulsate \
	--auto-close \
	--auto-kill \
	--time-remaining
if [ "$?" = -1 ] ; then
        zenity --error \
          --text="Download canceled."
fi
cd $VideoLocation
mkdir $PlayName
cd $PlayName
(youtube-dl -c --retries infinite --audio-quality 0 -f 'bestvideo[ext=mp4][height<=1080][height>=360]+bestaudio' --max-filesize 500M --no-overwrites --add-metadata --metadata-from-title --write-auto-sub --youtube-skip-dash-manifest --embed-thumbnail --embed-subs -o '%(playlist_index)s-%(title)s.%(ext)s' $PlayLink) |
zenity --progress \
	--title="Downloading video" \
	--text="Fetching video from YouTube..." \
	--percentage=0 \
	--pulsate \
	--auto-close \
	--auto-kill \
	--time-remaining
if [ "$?" = -1 ] ; then
        zenity --error \
          --text="Download canceled."
fi
zenity --info --text="Success."
